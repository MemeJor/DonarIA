<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>DonarIA – Encuentra tu causa</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

<header>
  <h1>DonarIA</h1>
  <p>Tu asistente ético para encontrar causas sociales alineadas con tus valores</p>
</header>

<section>
  <h2>1. Cuestionario inicial</h2>
  <form id="donarForm">
    <label for="temas">Selecciona tus causas sociales:</label>
    <select id="temas" multiple>
      <option value="infancia">Infancia y adolescencia</option>
      <option value="medioambiente">Medio ambiente</option>
      <option value="salud">Salud</option>
      <option value="discapacidad">Discapacidad</option>
      <option value="cooperacion">Cooperación internacional</option>
      <option value="educacion">Educación</option>
      <option value="derechoshumanos">Derechos humanos</option>
      <option value="genero">Igualdad de género</option>
      <option value="inclusion">Inclusión social</option>
      <option value="cultura">Cultura</option>
      <option value="investigacion">Investigación científica</option>
      <option value="animal">Protección animal</option>
      <option value="rural">Desarrollo rural</option>
      <option value="emergencias">Emergencias humanitarias</option>
      <option value="mayores">Personas mayores</option>
      <option value="migracion">Migración y refugio</option>
      <option value="pobreza">Lucha contra la pobreza</option>
      <option value="voluntariado">Voluntariado</option>
      <option value="economia">Economía social</option>
    </select>

    <label for="ubicacion">¿Prefieres causas en España, internacionales o ambas?</label>
    <select id="ubicacion">
      <option value="espana">España</option>
      <option value="internacional">Internacionales</option>
      <option value="ambas">Ambas</option>
    </select>

    <label for="tipo">¿Eres persona física o jurídica?</label>
    <select id="tipo">
      <option value="fisica">Física</option>
      <option value="juridica">Jurídica</option>
    </select>

    <button type="submit">Buscar entidades</button>
  </form>
</section>

<section>
  <h2>2. Entidades sugeridas</h2>
  <input type="text" id="buscador" placeholder="Buscar por nombre o causa..." />
  <div class="results" id="resultados">
    <p><em>Los resultados aparecerán aquí tras completar el formulario.</em></p>
  </div>
  <div class="pagination" id="paginador"></div>
  <button class="compare-btn" onclick="compararEntidades()">Comparar seleccionadas</button>
</section>

<section>
  <h2>3. Asistente IA</h2>
  <div class="assistant">
    <p><strong>DonarIA dice:</strong> Estoy aquí para ayudarte a encontrar causas alineadas con tus valores. Puedes buscar, filtrar y comparar hasta tres entidades antes de decidir.</p>
  </div>
</section>

<section>
  <h2>4. Seguridad y transparencia</h2>
  <ul>
    <li>Solo se muestran entidades activas y verificadas con utilidad pública.</li>
    <li>Incluye enlaces oficiales y apartados de transparencia y donaciones.</li>
    <li>No se almacenan datos personales.</li>
    <li>La desgravación fiscal se aplica según normativa común.</li>
    <li>Todos los enlaces son revisados manualmente antes de ser publicados.</li>
  </ul>
</section>

<script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
<script src="script.js"></script>
<script>
  new Choices('#temas', {
    removeItemButton: true,
    searchEnabled: true,
    placeholderValue: 'Selecciona causas sociales',
    searchPlaceholderValue: 'Buscar...'
  });

  document.getElementById('buscador').addEventListener('input', function () {
    const query = this.value.toLowerCase();
    entidades = entidades.filter(e =>
      e.nombre.toLowerCase().includes(query) ||
      (e.causas && e.causas.some(c => c.includes(query)))
    );
    paginaActual = 1;
    mostrarEntidades();
  });

  document.getElementById('donarForm').addEventListener('submit', function (e) {
    e.preventDefault();
    fetch('entidades.json')
      .then(res => res.json())
      .then(data => {
        const ubicacion = document.getElementById('ubicacion').value;
        const causasSeleccionadas = Array.from(document.getElementById('temas').selectedOptions).map(o => o.value);
        entidades = data.filter(ent =>
          (ubicacion === "ambas" || ent.ambito === ubicacion) &&
          (causasSeleccionadas.length === 0 || causasSeleccionadas.some(c => ent.causas.includes(c)))
        );
        paginaActual = 1;
        seleccionadas = [];
        mostrarEntidades();
      });
  });
</script>

</body>
</html>
